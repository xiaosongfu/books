https://kind.sigs.k8s.io/
https://github.com/kubernetes-sigs/kind

---

* 1. å®‰è£… kind
    * 1.1 ä½¿ç”¨ go å·¥å…·é“¾ç¼–è¯‘å®‰è£…
    * 1.2 ç›´æ¥ä¸‹è½½é¢„ç¼–è¯‘äºŒè¿›åˆ¶å¯æ‰§è¡Œæ–‡ä»¶(æ¨è)

* 2. åˆ›å»ºå•èŠ‚ç‚¹å’Œå¤šèŠ‚ç‚¹
    * 2.1 åˆ›å»ºå•èŠ‚ç‚¹é›†ç¾¤
    * 2.2 åˆ›å»ºå¤šèŠ‚ç‚¹é›†ç¾¤
    * 2.3 é”€æ¯é›†ç¾¤

* 3. å¼€å§‹ä½¿ç”¨

---

## 1. å®‰è£… kind

éœ€è¦å…ˆå®‰è£… docker å’Œ kubectlã€‚

å®‰è£… kubectlï¼š

```
curl -LO https://storage.googleapis.com/kubernetes-release/release/v1.13.4/bin/linux/amd64/kubectl && chmod +x kubectl && sudo mv kubectl /usr/local/bin/
```

##### 1.1 ä½¿ç”¨ go å·¥å…·é“¾ç¼–è¯‘å®‰è£…

ä½¿ç”¨ go å·¥å…·é“¾å®‰è£…ï¼Œéœ€è¦å·²ç»å®‰è£…äº† goï¼Œä½¿ç”¨ä»¥ä¸‹å‘½ä»¤å®‰è£…ï¼š

```
go get -u sigs.k8s.io/kind
```

##### 1.2 ç›´æ¥ä¸‹è½½é¢„ç¼–è¯‘äºŒè¿›åˆ¶å¯æ‰§è¡Œæ–‡ä»¶(æ¨è)

```
curl -Lo kind https://github.com/kubernetes-sigs/kind/releases/download/0.2.1/kind-linux-amd64 && chmod +x kind && sudo mv kind /usr/local/bin/
```

## 2. åˆ›å»ºå•èŠ‚ç‚¹å’Œå¤šèŠ‚ç‚¹

##### 2.1 åˆ›å»ºå•èŠ‚ç‚¹é›†ç¾¤

```
kind create cluster
```

`--name`ï¼šé›†ç¾¤çš„é»˜è®¤ context ä¸º kindï¼Œå¯ä»¥ä½¿ç”¨è¯¥å‚æ•°è‡ªå®šä¹‰
`--wait 5s`ï¼šä½¿ç”¨è¯¥å‚æ•°é˜»å¡ç­‰å¾…æ§åˆ¶é¢æ¿å‡†å¤‡å¥½ï¼Œå¿…é¡»åŠ ä¸Šæ—¶é—´ï¼Œå¦‚ 30sã€5m

> æ‰§è¡Œè®°å½•

```
$ kind create cluster
Creating cluster "kind" ...
 âœ“ Ensuring node image (kindest/node:v1.13.4) ğŸ–¼
 âœ“ Preparing nodes ğŸ“¦
 âœ“ Creating kubeadm config ğŸ“œ
 âœ“ Starting control-plane ğŸ•¹ï¸
Cluster creation complete. You can now use the cluster with:

export KUBECONFIG="$(kind get kubeconfig-path --name="kind")"
kubectl cluster-info
```

```
$ export KUBECONFIG="$(kind get kubeconfig-path --name="kind")"

$ kubectl cluster-info
```

##### 2.2 åˆ›å»ºå¤šèŠ‚ç‚¹é›†ç¾¤

`--config`ï¼šæŒ‡å®šé…ç½®æ–‡ä»¶

ä½¿ç”¨ä¸‹é¢è¿™ä¸ªé…ç½®æ–‡ä»¶å¯ä»¥å¯åŠ¨3èŠ‚ç‚¹çš„é›†ç¾¤ï¼š

```
# three node (two workers) cluster config
kind: Cluster
apiVersion: kind.sigs.k8s.io/v1alpha3
nodes:
- role: control-plane
- role: worker
- role: worker
```

```
kind create cluster --config kind-config.yaml
```

å®˜æ–¹å®Œæ•´é…ç½®æ–‡ä»¶ç¤ºä¾‹ï¼šhttps://raw.githubusercontent.com/kubernetes-sigs/kind/master/site/content/docs/user/kind-example-config.yaml

##### 2.3 é”€æ¯é›†ç¾¤

```
kind delete cluster
```

## 3. å¼€å§‹ä½¿ç”¨

cluster åˆ›å»ºå®Œæˆåå°±å¯ä»¥ä½¿ç”¨ kubectl å’Œé›†ç¾¤äº¤äº’äº†ï¼Œè¿™éœ€è¦ç”¨åˆ° kind ç”Ÿæˆçš„é…ç½®æ–‡ä»¶ï¼š

```
export KUBECONFIG="$(kind get kubeconfig-path)"
kubectl cluster-info
```

`kind get kubeconfig-path` è¿”å›ç”Ÿæˆçš„é…ç½®æ–‡ä»¶çš„ä½ç½®ã€‚
